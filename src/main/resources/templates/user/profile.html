<!DOCTYPE html>
<html lang="en" xmlns:c="http://www.w3.org/1999/XSL/Transform" xmlns:th="http://www.w3.org/1999/xhtml" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="layout/common :: head('Instargram')"></head>
<body>
<head th:replace="layout/common :: menu('menu')"></head>
<!--프로필 섹션-->
<main class="profile_main">
  <section class="profile">
    <!--유저정보 컨테이너-->
    <div class="profileContainer">
      <!--유저 이미지-->
      <div class="profile-left">
        <div class="profile-img-wrap story-border">
          <form id="userProfileImageForm">
            <input type="file" name="profileImageFile" style="display: none;" id="userProfileImageInput" />
          </form>
          <img class="profile-image" th:src="@{${'/profile_imgs/' + findUserDto.imageUrl}}" onerror="this.src='/img/default_profile.jpg';"/>
        </div>
      </div>
      <!--유저 이미지 end-->
      <!--유저정보 및 사진등록 구독하기-->
      <div class="profile-right">
        <div class="name-group" >
          <h2 style="font-size: 1.2em; margin-top: 25px; margin-bottom: 20px" th:text="${findUserDto.name}"></h2>
          <button class="cta" th:if="${findUserDto.login}" onclick="location.href='/user/update'">프로필 편집</button>
          <span></span>
          <button class="cta" th:if="!${findUserDto.login} and !${findUserDto.follow}" th:onclick="|toggleSubscribe(${findUserDto.id}, this)|">팔로우</button>
          <button class="cta" th:if="!${findUserDto.login} and ${findUserDto.follow}" th:onclick="|toggleSubscribe(${findUserDto.id}, this)|">팔로잉</button>
          <button class="modi" th:if="${findUserDto.login}" onclick="popup('.modal-info')">
            <i class="fas fa-cog"></i>
          </button>
        </div>

        <div class="subscribe">
          <ul>
            <li>게시물 <span style="font-weight: bold;" th:text="${findUserDto.postCount}" ></span></li>
            <li><a class="follow" th:onclick="|followerInfoModalOpen(${findUserDto.id})|" style="text-decoration:none">팔로워 </a><span style="font-weight: bold;" th:text="${findUserDto.followerCount}" ></span>
            <li><a class="follow" th:onclick="|followingInfoModalOpen(${findUserDto.id})|" style="text-decoration:none">팔로잉 </a><span style="font-weight: bold;" th:text="${findUserDto.followingCount}" ></span>
          </ul>
        </div>
        <div class="state">
          <h4 th:text="${findUserDto.username}"></h4>
          <div class="description-class" th:text="${findUserDto.description}">DESCRIPTION TEXT</div>
          <h5 style="color: #0074cc;" th:text="${findUserDto.link}"></h5>
        </div>
      </div>
      <!--유저정보 및 사진등록 구독하기 end-->
    </div>
  </section>
  <!--게시물 섹션-->
  <hr style="background-color: lightgray; margin: 10px 0; height: 1px;">
  <section id="tab-content">
    <!--게시물 컨테이너-->
    <div class="profileContainer">
      <!--그냥 감싸는 div (지우면 이미지 커짐)-->
      <div id="tab-1-content" class="tab-content-item show">
        <!--게시물컨 그리드 배열-->
        <div class="tab-1-content-inner" id="img-box" >
          <!--아이템들-->
          <div class="img-box" th:each="post : ${findUserDto.posts}" th:onclick="|postPopup(${post.id}, '.modal-post')|">
            <img th:src="@{${'/upload/' + post.imageUrl}}" />
            <div class="comment">
              <a> <i class="fas fa-heart"></i><span th:text="${post.likeCount}"></span></a>
            </div>
          </div>
          <!--아이템들 end-->
        </div>
      </div>
    </div>
  </section>

  <!--로그아웃, 회원정보 변경 모달-->
  <div class="modal-info">
    <div class="modal">
      <button onclick="location.href='/user/update'">회원정보 변경</button>
      <button onclick="location.href='/logout'">로그아웃</button>
      <button onclick="closePopup('.modal-info')">취소</button>
    </div>
  </div>
  <!--로그아웃, 회원정보 변경 모달 end-->

  <!--포스트 상세 정보 모달-->
  <div class="modal-post" id="modal-post">
    <div class="subscribe">
      <div class="subscribe-list" id="postInfoModal"></div>
    </div>
  </div>
  <!--포스트 상세 정보 모달 end-->

  <!--프로필사진 바꾸기 모달-->
  <div class="modal-image" >
    <div class="modal">
      <p>프로필 사진 바꾸기</p>
      <button >사진 업로드</button>
      <button >취소</button>
    </div>
  </div>
  <!--프로필사진 바꾸기 모달 end-->

  <div class="modal-follower">
    <div class="subscribe">
      <div class="subscribe-header">
        <span>팔로워</span>
        <button class="exit" onclick="modalClose()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="subscribe-list" id="followerModalList"></div>
    </div>
  </div>

  <div class="modal-following">
    <div class="subscribe">
      <div class="subscribe-header">
        <span>팔로잉</span>
        <button class="exit" onclick="modalClose()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="subscribe-list" id="followingModalList"></div>
    </div>
  </div>
  <div id="#mask"></div>
  <footer th:replace="layout/common :: footer('footer')"></footer>
</main>
<script th:inline="javascript">
</script>
<script src="/js/profile.js"></script>
</body>
</html>